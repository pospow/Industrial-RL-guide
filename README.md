# Industrial-RL-guide
Some helpful guidelines for prospective industrial RL engineers (written in Korean)

## 강화학습(RL)을 함께 연구하는 분들께  

반갑습니다. 저는 현재 LG전자 인공지능연구소에서 RL엔지니어로 일하고 있는 이재호라고합니다.  

이 repo를 통해서는 RL에 대한 일정 수준 이상의 이해도를 갖고있는 RL연구자를 대상으로 현재 실무(혹은 academy)에서 RL을 어떻게 풀어나가고 있는지에 대해 간단히 소개하고, 이를 통해 Industrial RL Engineer로써 필요한 기초 소양 및 지식, 또 가장 중요하게는 연구 방향성 설정에 대한 이야기를 하고자합니다.  

물론 저 역시도 아직 RL에 대해 모르는 것이 너무나 많은 초보 엔지니어지만, 머리속으로 내용을 다시 정리하면서 저 역시 공부하는 기회가 되고, 또 이제 막 RL 연구를 시작하고자 하는 분들에게 조금이나마 시행착오를 줄일 수만 있어도 좋겠다는 바람입니다.  


## 왜 다른 인공지능이 아닌 RL인가요? (내가 느끼는 요즘 인공지능)

일반적으로 인공지능 기술을 기술영역에 따라 아래와 같이 분류하기도 합니다  
1. Supervised Learning (지도학습)
2. Unsupervised Learning (비지도학습)
3. Reinforcement Learning (강화학습)

여기서 대다수의 사람들이 인공지능하면 떠올리는 분야는 지도학습일 것입니다. **지도학습**은 다량의 라벨링된 데이터(빅데이터)를 통해 학습하여 모델링 한 후, 그 모델을 이용하여 이전에는 각 분야 전문가들이나 가능했던 예측, 분류, 고장진단, 사물인식(행동인식) 및 음성인식 등을 자동화하는 것을 주 타겟으로 하고있습니다.  

다수의 라벨링된 데이터만 있다면 누구나 쉽게 적용할 수 있고, 최근 들어 이러한 학습을 도와주는 자동화된 툴들까지 많이 등장하고 있어 사실 인공지능에 대해 잘 모르는 사람들도 클릭 몇번으로 학습된 결과를 볼 수 있는 수준에까지 이르렀습니다. 하지만 여기서 가장 명확하게 드러나는 가장 큰 문제점이 바로 **데이터의 확보**입니다. 데이터 확보에서 발생하는 이슈들은 아래와 같습니다

 - 데이터 양이 많이 필요하다 (수십만 ~ 수백만 혹은 그 이상)
 - 데이터의 종류(라벨값)이 다양하게 골고루 분포되어야 한다
 - 데이터의 outlier들에 대한 전처리 작업이 필요하다
 
 요즘에는 데이터가 곧 돈이라고 할 수 있는 시대입니다. 실제로 회사에서는 이러한 데이터를 확보하기 위해 수천만원이 넘는 돈을 지불하고 구매하기도 합니다. 하지만 최근에는 이것이 단순히 돈의 문제가 아닌 개인 **프라이버시 이슈**로 인해 다시금 어려움에 봉착하고 있습니다. 가장 민감한 개인의 얼굴 사진에서부터 시작하여 목소리, 구매 내역, 생활패턴 및 CCTV 영상 등이 그 대표적인 예시입니다. 물론 기존에 이미 활발히 연구되었던 분야인 얼굴인식이나 행동인식 등은 이미 오픈된 소스들을 어느정도 확보할 수 있기 때문에 크게 문제가 되지 않는다고 생각할 수 있지만, 추가적인 성능향상을 위해서는 이외에 추가적인 데이터가 필수적이며 또 이렇게 기존에 이미 잘 알려진 타겟이 아닌 새로운 서비스를 제공하고자 할 때는 직접 새로운 데이터를 확보하는 것이 당연지사입니다.  
 
 이러한 문제를 해결하고자 구글에서 개발된 기술이 바로 `Federated Learning`입니다. 이것은 간단히 설명해서 수 많은 end-user들로부터 데이터를 직접 받는 대신, 그 데이터를 통해 업데이트 해야 할 weight를 전달 받는 방식으로 프라이버시 문제를 해결하는 것입니다. 물론 실제로는 훨씬 복잡한 기술이지만 어쨌든 최근에는 이러한 데이터 프라이버시를 해결하기 위해 많은 노력 및 연구가 진행되고 있다는 것을 말씀드리고 싶습니다.  
 
 또 두번째로는 데이터의 분포에 관한 것인데요, 가장 단순한 예시로 개 고양이 분류 task를 학습하는데 있어서 개 데이터 셋이 100개, 고양이 데이터셋이 10개라면, 당연히 학습 성능이 좋지 않을 것임을 알 수 있습니다. 방금은 정말 무식한(?) 예시이지만, 실제로 데이터 분포도가 균일한 경우는 없을 것이며, 이를 보정하기 위한 작업들이 필요할 것입니다.  
 
 마지막으로 데이터 outlier 처리인데요, 이 부분도 역시 잘 알려진 Pandas와 같은 툴을 이용하여 어느정도 보정이 가능하지만, 때에 따라서는 사람이 직접 손으로 작업해주어야 하는 risk가 생기기도 합니다. 
 
 서두가 길었지만 결론적으로 지도학습에 대한 저의 개인적인 생각은 아래와 같습니다
 
 > **이게 과연 인공지능인가? (인공신경망 != 인공지능)**
 
 말 그대로입니다. 여기서 과연 우리가 어떠한 `지능`을 기대해야 하는 것인지 잘 모르겠습니다. 제가 생각하는 `지능`에는 여러 조건들이 있겠지만, 가장 중요한 조건 중 하나인 무에서 유를 창조하는 독창성이 여기서는 결여되어 있는것입니다. 이것은 `인공지능`이라기보다 `인공신경망을 이용한 데이터 피팅`이 더 정확한 표현일지도 모릅니다. 지도학습에서는 데이터 없이는 아무것도 할 수 없고 실체도 없는, 유에서 조금 더 특별한 유를 창조하는 작업을 하는 것입니다. 물론 이렇게 얘기하면 혹자는 GAN(Generative Adversarial Network) 등을 얘기하며 독창성이 왜 없냐고 따질 수도 있는데요, GAN도 결국엔 수많은 데이터 토대위에 짓는 집일수밖에 없습니다. 따라서 지도학습에서의 주인공은 결국 어떠한 알고리즘적인 어프로치보다 데이터 확보에 관한 방법론이 더 현실적인 것입니다. 물론 이것이 결코 **잘못된 것은 아니며** 실제 산업계에서 지도학습을 통해 만들어 낼 수 있는 어마어마한 가치들을 생각했을 때 이것은 당연히 '수지 맞는 일' 입니다.  
 
 하지만 연구자로서 우리는 다시 생각해 볼 필요가 있습니다. 인공지능을 연구하시는 많은 분들이 저마다 꿈꾸는 목표와 그림이 다 다르겠지만, 제가 개인적으로 꿈꾸는 인공지능은 궁극적으로 사람의 사고방식을 그대로 기계에서 재현할 수 있는 것입니다. 사람은 태어났을 때부터 죽을 때까지 끊임없이 새로운 것을 학습하며 살아갑니다. 하지만 물론 지도학습에서처럼 사진 수십만장을 반복적으로 보여주며 학습하는 방식은 아닐 것입니다. 그렇다면 사람이 학습하는데에 있어서 가장 중요한 것은 무엇일까요? 저는 그것이 `상호작용(피드백)`이라고 생각합니다.    
 
 > **현재 인공지능에 가장 근접한 시도는 단연코 강화학습이다**
 
 그러한 맥락에서 바라볼 때 현재까지 인공지능 연구 중 가장 근접한 방법론이 바로 강화학습입니다. 강화학습은 실물(Real-world)와의 상호작용을 통해 디자이너가 의도한 방향대로 학습해 나갑니다. 여기서 구체적인 정답(라벨)은 없습니다. 다만 여러 시행착오(trial and error)를 통해 우리가 원하는 방향으로 학습해 나갈 수 있도록 길잡이 역할을 해주는 Reward만 존재합니다. 
 
 예를 들어 사람이 태어나서 처음 걸을 수 있게 되는 순간을 생각해봅니다. 아기는 처음에 기어다니는 것부터 시작해서 몇번의 시행착오(넘어짐)을 통해 결국 걷기 위한 방법을 학습하게 됩니다. 여기서 아기의 부모님이 매 순간마다 이 때는 다리 각도를 이렇게 해야 하고 또 저 때는 저렇게 해야 해라고 말해주지 않습니다. 그렇게 할 수도 없는 일입니다. 다만 아기 스스로 걷기 위한 방법들을 시도해보고 그 수많은 방법들 중 걸을 수 있는 방법을 끝내 터득하는 것입니다.
 
 > **"You don't learn to walk by following rules. You learn by doing, and by falling over" - Richard Branson**
 
 강화학습이 실물과의 상호작용을 통해 데이터로부터는 어느정도 자유로워진 것이 사실이지만, 세상에 공짜점심이 없듯이 강화학습에서도 길잡이 역할을 해줄 Reward 설계가 필수적이므로 처음부터 끝까지 기계가 100% 자동으로 학습하는 것은 아직 불가능합니다. 그래도 이 부분에 대해서 현재 연구가 활발히 진행되고 있는만큼 멀지 않은 미래에는 기계 스스로가 유의미한 task와 reward를 선정하여 학습하는 날이 오지 않을까요?  
 

## 강화학습 연구를 위한 필수(혹은 선택적) 소양
 - Tensorflow and Pytorch 
 - 확률/통계 관련 수학적 이론 지식
 - 인공신경망 기반 특징점(latent variable) 추출의 이해 (CNN, LSTM, Variational Auto-Encoder 등)
 - 병렬 프로그래밍 (python multiprocessing or mpi4py)
 - 통신 (시뮬레이션 프로그램 사용시 TCP/IP, FMI)
 - git 
 
 
## 최근 강화학습 연구 트렌드 (feat. NeurIPS 2020)
 - Off-policy(Offline) RL
 - Exploration & exploitation 
 - Safe RL (Constrained RL)
 - Generalization & Adaptation
 - Representation Learning
 - Optimization
 - Reward Design
